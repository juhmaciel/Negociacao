<html>
<head>
  <title>Calculadora de desconto</title>
  // Importa as bibliotecas necessárias
const fs = require("fs");

// Define as constantes
const QNT_PARCELAS_MAX = 12;
const VALOR_PARCELA_MAX = 150;

// Obtém os dados do formulário
const valor = Number(document.querySelector("input[name='valor']").value);
const desconto_vista = Number(document.querySelector("input[name='desconto_vista']").value);
const desconto_parcelado = Number(document.querySelector("input[name='desconto_parcelado']").value);
const qtd_parcelas = Number(document.querySelector("input[name='qtd_parcelas']").value);

// Valida a quantidade de parcelas
if (qtd_parcelas > QNT_PARCELAS_MAX) {
  alert("A quantidade de parcelas não pode ser superior a 12.");
  return;
}

// Calcula o valor do desconto à vista
const valor_desconto_vista = valor * desconto_vista / 100;

// Calcula o valor de cada parcela
const valor_parcela = valor / qtd_parcelas;

// Calcula o valor do desconto parcelado
const valor_desconto_parcelado = valor_parcela * desconto_parcelado / 100;

// Calcula o valor final
const valor_final = valor - valor_desconto_vista - valor_desconto_parcelado;

// Gera o código de desconto
const codigo_desconto = f"{desconto_vista}-{desconto_parcelado}-{qtd_parcelas}";

// Exibe o resultado
const resultado = `
  <h2>Resultado</h2>
  <ul>
    <li>Código de desconto: ${codigo_desconto}</li>
    <li>Valor do desconto: ${valor_desconto_vista + valor_desconto_parcelado}</li>
    <li>Valor final: ${valor_final}</li>
  </ul>
`;

document.querySelector("#resultado").innerHTML = resultado;

// Salva o resultado em um arquivo
fs.writeFile("resultado.html", resultado, "utf8", (err) => {
  if (err) {
    console.log(err);
  } else {
    console.log("Resultado salvo com sucesso.");
  }
});
</head>
<body>
  <h1>Calculadora de desconto</h1>

  <form action="/" method="post">
    <input type="text" name="valor" placeholder="Valor do produto ou serviço">
    <input type="number" name="desconto_vista" placeholder="Desconto à vista (%)">
    <input type="number" name="desconto_parcelado" placeholder="Desconto parcelado (%)">
    <input type="number" name="qtd_parcelas" placeholder="Quantidade de parcelas">
    <button type="submit">Calcular</button>
  </form>

  <div id="resultado"></div>
</body>
</html>
